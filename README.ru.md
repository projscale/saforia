# Saforia

Детерминированный генератор паролей: пароли для разных сервисов получаются из одного мастер‑пароля. Мастер‑пароль хранится только в зашифрованном виде, ключом для шифрования служит отдельный viewer‑пароль. Его можно вводить публично — он не раскрывает мастер‑пароль.

Статус: ранний прототип. Кроссплатформенное приложение (Tauri 2): Rust‑бэкенд и React + Vite фронтенд.

## Основные идеи
- Единственный мастер‑пароль (никогда не хранится в открытом виде). На диске шифруется Argon2id + ChaCha20‑Poly1305 под viewer‑пароль.
- Для каждого сервиса сохраняется постфикс (suffix). Для каждого постфикса выбирается метод генерации.
- Генерация детерминирована: хэш(master + postfix) → символы заданного алфавита.
- Обратная совместимость: поддержаны два исторических формата (v1 MD5+B64, v2 SHA256+URL‑B64).
- Новые методы: длины 10/20/36 символов, варианты только буквы+цифры и «с символами». По умолчанию — 36 с символами.
- Безопасность: скрытое отображение, копирование только по кнопке, авто‑очистка, best‑effort защита от снятия скриншотов (Windows/Mac).

## Сборка (Desktop)
- Требуется: Node 18+, Rust stable, Tauri 2.
- Установка зависимостей: `npm install`
- Дев‑режим: `npm run tauri:dev`
- Релиз: `npm run tauri:build`

## Сборка (Mobile)
- iOS: Xcode + таргеты Rust; открыть проект после `tauri build`.
- Android: Android Studio; NDK и таргеты Rust (`aarch64-linux-android`).

Мобильные шаги будут уточняться (флаги безопасности, подпись и т.д.).

## Безопасность
- Viewer‑пароль нигде не сохраняется и каждый раз запрашивается при генерации.
- KDF: Argon2id (параметры для desktop/mobile) + ChaCha20‑Poly1305.
- Буфер обмена — только по действию пользователя; содержимое очищается в UI через ~30 секунд.
- Защита от снятия экрана: best‑effort (Windows SetWindowDisplayAffinity, macOS NSWindow sharingType). Для Android/iOS будет добавлено (FLAG_SECURE / отслеживание захвата).

## Алгоритмы
- Legacy v1: Base64(MD5(master||postfix)) без `=`.
- Legacy v2: Base64(SHA256(master||postfix)) с заменами `=`→`.`, `+`→`-`, `/`→`_`.
- Новые (len10/20/36, alnum/strong): итеративный SHA‑256 от `master||"::"||postfix||"::"||method_id`; символы выбираются без смещения через rejection sampling.

## Структура
- `src/` — UI (React + Vite).
- `src-tauri/` — Rust‑бэкенд (Tauri 2), криптография/генерация/хранилище.
- `references/` — исторические скрипты для совместимости.

## План
- Реализовать мобильную защиту экрана и интеграцию буфера обмена.
- Импорт/экспорт списка постфиксов (опц. шифрованный архив).
- Показ «отпечатка» мастера в UI.
- Ужесточение настроек релиза (отключение devtools, CSP и т.п.).

Этот README будет пополняться по мере коммитов.

