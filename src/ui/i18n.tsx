import React from 'react'
import { invoke } from '../bridge'

export type Lang = 'en' | 'ru' | 'zh'

type Dict = Record<string, string>
type Bundle = Record<Lang, Dict>

const bundle: Bundle = {
  en: {
    howItWorks: 'How it works',
    navigation: 'Navigation',
    home: 'Home',
    menu: 'Menu',
    back: 'Back',
    settings: 'Settings…',
    settingsTitle: 'Settings',
    tabPreferences: 'Preferences',
    tabBackup: 'Backup',
    tabAbout: 'About',
    quickGenerate: 'Quick generate',
    savedListTitle: 'Saved postfixes',
    filterByMethod: 'Filter by method',
    sort: 'Sort',
    all: 'All',
    recent: 'Recent',
    alphabetical: 'Alphabetical',
    savePostfix: 'Save this postfix',
    postfixPlaceholder: 'example.com',
    labelPlaceholder: 'e.g., Example',
    copyPassword: 'Copy password',
    cancel: 'Cancel',
    viewerHelp: 'Viewer password is required on each generation and is never stored.',
    switchProfile: 'Switch profile',
    noMaster: 'No master',
    aboutIntro: 'Saforia is a deterministic password generator. It combines a master password (encrypted at rest by a viewer password) with a service postfix and derives a final password via hashing.',
    aboutOverviewP1: 'Saforia deterministically derives a password from three inputs: your Master, your per-device Viewer (used to decrypt Master), and a service-specific Postfix (e.g., example.com). The same inputs always yield the same output.',
    aboutOverviewP2: 'Nothing is sent to servers. Master is stored only encrypted. Viewer is never stored. Copy to clipboard happens only by your action (with optional auto-clear).',
    aboutConceptsTitle: 'Core concepts',
    aboutMasterTitle: 'Master',
    aboutMasterBody: 'Root secret used to derive final passwords. Stored only encrypted, never in plaintext.',
    aboutViewerTitle: 'Viewer',
    aboutViewerBody: 'Per-device unlock password that decrypts the Master when generating. Never persisted.',
    aboutPostfixTitle: 'Postfix',
    aboutPostfixBody: 'Service identifier (e.g., example.com). It is treated as sensitive; hidden by default in lists.',
    aboutMethodTitle: 'Method',
    aboutMethodBody: 'Template for length and character set (alnum vs strong). Legacy methods are kept for compatibility.',
    aboutGenerationTitle: 'How generation works',
    aboutGenStep1: 'Enter Postfix and choose Method (or use the default).',
    aboutGenStep2: 'Open viewer prompt and enter your Viewer to decrypt Master.',
    aboutGenStep3: 'The app combines Master + Postfix + Method and hashes to a final password.',
    aboutGenStep4: 'Optionally save Postfix with a label for quick access later.',
    aboutGenStep5: 'Copy explicitly when you need it (button).',
    aboutGenStep6: 'Clipboard can auto-clear after a delay (configurable).',
    aboutMethodsDetailsTitle: 'Methods and strength',
    aboutMethodsAlnum: 'Alnum: only letters and digits; better compatibility with strict forms.',
    aboutMethodsStrong: 'Strong: includes symbols for higher entropy; preferred when allowed.',
    aboutMethodsLength: 'Longer is stronger. Choose 20–36 for primary accounts; 10 for legacy constraints.',
    aboutMethodsLegacy: 'Legacy v1/v2 are for historical parity. Prefer modern strong methods for new entries.',
    aboutUsingTitle: 'Using the app effectively',
    aboutUsingQuick: 'Quick generate: enter Postfix, pick Method, generate, copy. Optionally auto-save the entry.',
    aboutUsingSave: 'Saving: enable “Save this postfix” and set a short Label (e.g., Example).',
    aboutUsingSaved: 'Saved entries: open viewer prompt per entry to generate and copy without retyping Postfix.',
    aboutUsingShowPostfixWarning: 'Showing Postfix column is discouraged (sensitive). Keep it hidden unless necessary.',
    aboutUsingReorder: 'Reordering: drag saved rows via the handle to set a custom order per Master; this order is stored and used across sessions and exports.',
    aboutOutputClipboardTitle: 'On-screen output and clipboard',
    aboutOutputReveal: 'Reveal on screen is transient. You can toggle or hold-to-reveal (configurable).',
    aboutOutputHold: 'Hold-to-reveal shows the secret only while pressed.',
    aboutOutputTimer: 'Auto-hide output after N seconds (0 = off).',
    aboutOutputExtend: 'You can extend the timer when needed.',
    aboutClipboardCopy: 'Copy happens only when you click Copy; no auto-copy unless explicitly enabled.',
    aboutClipboardAutoClear: 'Clipboard can auto-clear after N seconds to reduce exposure.',
    aboutSecurityPrivacyTitle: 'Security and privacy',
    aboutSecurityMask: 'Mask sensitive content (Wayland or presentations) to avoid leaks on screen.',
    aboutSecurityBlockWhileCaptured: 'Block while captured: disables actions when OS reports screen recording/mirroring.',
    aboutSecurityClearOnBlur: 'Clear on blur/hidden: hides output and clears clipboard when app loses focus.',
    aboutSecurityWayland: 'Wayland notice: global capture detection is limited — masking helps in this case.',
    aboutSecurityNoNetwork: 'No network dependency for generation—data stays on your device.',
    aboutBackupTitle: 'Backup and import',
    aboutBackupExport: 'Export a backup to a .safe file that contains only your saved entries (labels, postfixes, methods, timestamps, master fingerprints), never your master or viewer passwords. If you set a passphrase it encrypts the JSON inside using Argon2id + ChaCha20‑Poly1305; without a passphrase it stays plain JSON, so prefer a strong passphrase and store the file on encrypted disk or another protected location.',
    aboutBackupImport: 'Import a .safe file on the Backup tab to restore your Saved list on this device. Entries are tied to the master fingerprint they were created with, so first set up the same master password, then choose whether to merge with existing entries or enable Overwrite to fully replace them.',
    aboutCsvTitle: 'CSV import/export',
    aboutCsvNotes: 'Use CSV for one‑time migration or inspection. The file is plain text with columns “fingerprint,label,postfix,method_id,created_at,id”; you will map imported fingerprints to your local Masters during import. Treat CSV as sensitive (no encryption), keep it only as long as needed, and delete it afterward.',
    aboutLinksTitle: 'Links',
    aboutLinkSite: 'Website',
    aboutLinkRepo: 'Repository',
    aboutSecurityTitle: 'Security model',
    aboutSec1: 'Master is stored only in encrypted form.',
    aboutSec2: 'Viewer is never persisted; it unlocks the master for generation only.',
    aboutSec3: 'Clipboard copy is explicit; optional auto-clear available.',
    general: 'General',
    security: 'Security',
    output: 'Output',
    close: 'Close',
    helpGeneral: 'Basic app preferences and defaults.',
    helpSecurity: 'Privacy and safety related options.',
    helpOutputSection: 'On-screen output and reveal/expiry behavior.',
    language: 'Language',
    addMaster: 'Add Master…',
    bindLegacy: 'Bind legacy entries to active',
    noneSaved: 'None saved',
    masters: 'Masters',
    use: 'Use',
    del: 'Del',
    active: 'Active',
    search: 'Search…',
    label: 'Label',
    method: 'Method',
    postfix: 'Postfix',
    actions: 'Actions',
    dragToReorder: 'Drag to reorder',
    save: 'Save',
    generate: 'Generate',
    deleteEntry: 'Delete',
    initialSetup: 'Initial setup',
    masterPassword: 'Master password',
    confirmMaster: 'Confirm master password',
    viewerPassword: 'Viewer password',
    confirmViewer: 'Confirm viewer password',
    saveMaster: 'Save master',
    defaultMethod: 'Default method',
    maskSensitive: 'Mask sensitive content (Linux/Wayland)',
    autosaveQuick: 'Autosave in Quick generate',
    autoClearClipboard: 'Auto-clear clipboard (seconds, 0 = off)',
    helpDefault: 'Affects Quick generate and defaults for newly added entries.',
    helpMask: 'On Wayland, global capture blocking is not guaranteed — masking keeps secrets hidden.',
    helpAutosave: 'When enabled, the “Save this postfix” option is checked by default in Quick generate.',
    helpAutoClear: 'Clears system clipboard contents after a delay; set to 0 to disable.',
    blockWhileCaptured: 'Block actions while screen capture is detected',
    helpBlockWhileCaptured: 'When enabled, generate/copy are disabled if the system reports active recording/mirroring.',
    showPostfixInList: 'Show postfix column in list (not recommended)',
    helpShowPostfixInList: 'Postfix is sensitive input and typically should not be shown.',
    viewerPromptTimeoutSeconds: 'Viewer prompt timeout (seconds)',
    helpViewerPrompt: 'Closes the viewer prompt after inactivity to avoid shoulder-surfing.',
    outputClearSecondsLabel: 'Auto-clear on-screen output (seconds, 0 = off)',
    helpOutputClear: 'Hides generated password on screen after a delay; clipboard clearing is configured separately.',
    copyOnConsoleGenerate: 'Copy to clipboard after console generate',
    helpCopyOnConsole: 'If enabled, copies generated password immediately when using the console.',
    holdOnlyReveal: 'Only hold-to-reveal (hide toggle button)',
    helpHoldOnlyReveal: 'Removes the toggle Reveal/Hide button; secrets are visible only while holding.',
    clearClipboardOnBlur: 'Clear clipboard on app blur/hidden',
    helpClearOnBlur: 'Clears clipboard and hides output when the app loses focus or becomes hidden.',
    autoCloseIn: 'Auto-close in',
    generating: 'Generating…',
    deleting: 'Deleting…',
    // toasts & dialogs
    toastMasterSaved: 'Master password saved (encrypted by viewer password).',
    toastCopied: 'Copied to clipboard',
    toastCopyFailed: 'Copy failed. Please copy manually.',
    toastEntryDeleted: 'Entry deleted',
    toastEntryDeleteFailed: 'Failed to delete entry',
    toastGenerateFailed: 'Failed to generate',
    toastBoundEntriesPrefix: 'Bound ',
    toastBoundEntriesSuffix: ' entries',
    toastActiveChanged: 'Active master changed',
    toastMasterDeleted: 'Master deleted',
    toastMasterDeleteFailed: 'Delete failed',
    confirmDeleteMaster: 'Delete this master?',
    copy: 'Copy',
    pin: 'Pin',
    unpin: 'Unpin',
    masterMismatch: 'Master passwords do not match',
    viewerMismatch: 'Viewer passwords do not match',
    errEnterBoth: 'Enter both master and viewer passwords',
    toastSaveMasterFailedPrefix: 'Failed to save master: ',
    toastWrongViewer: 'Wrong viewer password',
    setupMasterExplain: 'This is the single secret Saforia uses to deterministically derive every site password. If you change the Master, the passwords generated for every site will also change, so pick something long and unique.',
    setupViewerExplain: 'Viewer stays on this device only. Saforia encrypts your stored Master with the Viewer so malware or stray apps cannot silently read it, and because Viewer is unrelated to actual site passwords you can safely type it even if someone is filming.',
    // backup
    exportToPath: 'Export to path',
    passphraseOptional: 'Passphrase (optional)',
    export: 'Export',
    exportedSuccessfully: 'Exported successfully',
    exportFailedPrefix: 'Export failed: ',
    exportHelp: 'Export as an encrypted Saforia archive (.safe) with an optional passphrase, or as plain CSV. Keep passphrases safe.',
    exportFormat: 'Export format',
    formatSafe: 'Saforia archive (.safe)',
    formatCsv: 'CSV (plain, unencrypted)',
    pickExportPath: 'Pick where to save',
    downloadBackup: 'Download backup',
    savingTo: 'Saving to',
    helpExport: 'Exports saved postfixes as JSON or an encrypted archive if passphrase is provided. Keep passphrases safe.',
    importFromPath: 'Import from path',
    passphraseIfUsed: 'Passphrase (if used)',
    overwrite: 'Overwrite',
    yes: 'Yes',
    no: 'No',
    import: 'Import',
    importedCountPrefix: 'Imported ',
    importedCountSuffix: ' entries',
    importFailedPrefix: 'Import failed: ',
    importHelp: 'Import merges with existing entries by default; choose Overwrite to replace all.',
    importHelpWithMapping: 'Import a .safe backup. If the viewer differs on this device, drag imported fingerprints to local masters — unmapped fingerprints are skipped.',
    dropOrPickFile: 'Drop a .safe/.json file or pick one',
    acceptedFormats: 'Accepted formats:',
    chooseFile: 'Choose file',
    previewMapping: 'Preview & map',
    helpImport: 'Import merges with existing entries by default; choose Overwrite to replace all.',
    helpCsv: 'CSV mapping is available on desktop only for now.',
    csvBackupTitle: 'CSV Backup',
    exportCsvToPath: 'Export CSV to path',
    exportCsv: 'Export CSV',
    exportedCsv: 'Exported CSV',
    exportCsvFailedPrefix: 'Export CSV failed: ',
    csvImportPath: 'Import CSV from path',
    previewCsvImport: 'Preview CSV import',
    preview: 'Preview',
    csvMapTitle: 'Map imported fingerprints',
    mapFingerprints: 'Match fingerprints to local masters',
    mapFingerprintsHelp: 'Drag a local master fingerprint to each imported fingerprint. Only mapped ones will be imported.',
    unmappedSkipped: 'Unmapped fingerprints will be skipped',
    nothingMapped: 'Nothing mapped to import',
    csvAppOnly: 'CSV import/export is available only in the desktop app.',
    desktopOnly: 'Desktop only',
    unbound: 'Unbound',
    applyMapping: 'Apply mapping',
    apply: 'Apply',
    dropLocalHere: 'Drop local here',
    dropHereToIgnore: 'Drop here to ignore',
    importedFingerprints: 'Imported fingerprints',
    localMastersDrag: 'Local masters (drag to map)',
    // overlay
    overlayTitleCapture: 'Screen capture detected',
    overlayTitleMasked: 'Sensitive content masked',
    overlayMsgCapture: 'For your security, sensitive content is hidden while recording or mirroring is active.',
    overlayMsgWaylandMask: 'On Linux/Wayland, capture blocking is not guaranteed. Mask mode is enabled.',
    overlayMsgMaskEnabled: 'Mask mode is enabled by preferences.',
    // reveal UI
    holdToReveal: 'Hold to reveal',
    releaseToHide: 'Release to hide',
    hide: 'Hide',
    reveal: 'Reveal',
    emptyListHelp: 'No saved postfixes yet. Use the console below to generate and save your first site, or import from Backup.',
    ignore: 'Ignore',
    failedPrefix: 'Failed: ',
    toastSanitizedInput: 'Removed invisible/unsupported characters from input.',
    warnInvisibleChars: 'Input contains invisible/unsupported characters.',
    exporting: 'Exporting…',
    importing: 'Importing…',
    loading: 'Loading…',
    applying: 'Applying…',
    postfixHiddenHint: 'Postfix is hidden by default for security. You can enable it in Settings → Preferences.',
    extend: 'Extend',
    extendSecondsLabel: 'Extend (+s)',
    // setup placeholders / verbs
    saving: 'Saving…',
    masterPlaceholder: 'Strong master',
    masterRepeatPlaceholder: 'Repeat master',
    viewerPlaceholder: 'Device-only viewer',
    viewerRepeatPlaceholder: 'Repeat viewer',
    // fingerprint
    fingerprintTitle: 'Master fingerprint',
    fingerprintHelp: 'Enter the viewer password for this device to verify the current master password identity (MD5 fingerprint).',
    fingerprintLabel: 'Fingerprint (MD5 of master):',
    viewMaster: 'View master',
    revealMaster: 'Reveal master with viewer',
    copyMaster: 'Copy master',
    masterRevealed: 'Master password',
    revealMasterHelp: 'Enter this device’s viewer password to decrypt and show the full master. Keep the screen private before revealing.',
    // setup help
    setupIntro: 'Set a strong Master password and a device-only Viewer. Master is encrypted at rest with Viewer and never stored in plain text.',
    setupMasterHelp: 'Master is the root secret used to derive your passwords.',
    setupViewerHelp: 'Viewer decrypts your Master locally and is never persisted.',
    setupNote1: 'Use a long unique Master (e.g., 16+ chars).',
    setupNote2: 'Viewer can differ per device; keep it memorable.',
    setupNote3: 'You can change both later from Settings.',
    setupStepLabel: 'Step 1 · Create your keys',
    setupTagline: 'Define Master and Viewer once to unlock the rest of the app.',
    setupHint: 'You will only set these once. You can manage them later from Settings.',
  },
  ru: {
    howItWorks: 'Как это работает',
    navigation: 'Навигация',
    home: 'Домой',
    menu: 'Меню',
    back: 'Назад',
    settings: 'Настройки…',
    settingsTitle: 'Настройки',
    tabPreferences: 'Параметры',
    tabBackup: 'Резервное копирование',
    tabAbout: 'О программе',
    quickGenerate: 'Быстрая генерация',
    savedListTitle: 'Сохранённые постфиксы',
    filterByMethod: 'Фильтр по методу',
    sort: 'Сортировка',
    all: 'Все',
    recent: 'Недавние',
    alphabetical: 'По алфавиту',
    savePostfix: 'Сохранить постфикс',
    postfixPlaceholder: 'example.com',
    labelPlaceholder: 'например, Example',
    copyPassword: 'Копировать пароль',
    cancel: 'Отмена',
    viewerHelp: 'Viewer‑пароль требуется при каждой генерации и не сохраняется.',
    switchProfile: 'Сменить профиль',
    noMaster: 'Нет мастера',
    aboutIntro: 'Saforia — детерминированный генератор паролей. Он соединяет мастер‑пароль (на диске хранится только в зашифрованном виде под viewer‑паролем) и постфикс сервиса, затем по хэшу получает конечный пароль.',
    aboutOverviewP1: 'Saforia детерминированно получает пароль из трёх сущностей: вашего Мастера (Master), вашего локального Viewer (используется для расшифровки Мастера на устройстве) и Постфикса сервиса (например, example.com). При одинаковых входах результат всегда один и тот же.',
    aboutOverviewP2: 'Никаких серверов. Мастер хранится только зашифрованно. Viewer никогда не сохраняется. Копирование — только по вашему действию (доступна авто‑очистка).',
    aboutConceptsTitle: 'Ключевые понятия',
    aboutMasterTitle: 'Мастер (Master)',
    aboutMasterBody: 'Корневой секрет для вывода паролей. Хранится только в зашифрованном виде, никогда в открытом.',
    aboutViewerTitle: 'Viewer',
    aboutViewerBody: 'Локальный на устройстве пароль для расшифровки Мастера перед генерацией. Не сохраняется.',
    aboutPostfixTitle: 'Постфикс',
    aboutPostfixBody: 'Идентификатор сервиса (например, example.com). Считается чувствительным — по умолчанию скрыт в списках.',
    aboutMethodTitle: 'Метод',
    aboutMethodBody: 'Шаблон длины и набора символов (alnum vs strong). Legacy‑методы оставлены для совместимости.',
    aboutGenerationTitle: 'Как происходит генерация',
    aboutGenStep1: 'Введите Постфикс и выберите Метод (или используйте метод по умолчанию).',
    aboutGenStep2: 'Откройте окно Viewer и введите Viewer для расшифровки Мастера.',
    aboutGenStep3: 'Приложение объединяет Master + Postfix + Method и по хэшу получает итоговый пароль.',
    aboutGenStep4: 'По желанию сохраняйте Постфикс с короткой Меткой для быстрого доступа.',
    aboutGenStep5: 'Копируйте только по кнопке, когда это действительно нужно.',
    aboutGenStep6: 'Буфер можно авто‑очищать через задержку (настраивается).',
    aboutMethodsDetailsTitle: 'Методы и стойкость',
    aboutMethodsAlnum: 'Alnum: только буквы и цифры — больше совместимости с строгими формами.',
    aboutMethodsStrong: 'Strong: добавлены символы — больше энтропии; предпочтительно, если форма разрешает.',
    aboutMethodsLength: 'Длина важна: 20–36 для основных аккаунтов; 10 — для старых ограничений.',
    aboutMethodsLegacy: 'Legacy v1/v2 — для исторической совместимости. Для новых записей используйте современные strong‑методы.',
    aboutUsingTitle: 'Эффективное использование',
    aboutUsingQuick: 'Быстрая генерация: введите Постфикс, выберите Метод, сгенерируйте и скопируйте. Можно сразу сохранить запись.',
    aboutUsingSave: 'Сохранение: включите «Сохранить постфикс» и задайте короткую Метку (например, Example).',
    aboutUsingSaved: 'Сохранённые записи: открывайте окно Viewer для записи и копируйте без повторного ввода Постфикса.',
    aboutUsingShowPostfixWarning: 'Показывать столбец Постфикса обычно не нужно (это чувствительные данные). Открывайте его только при необходимости.',
    aboutUsingReorder: 'Порядок: перетаскивайте строки за специальный хэндл, чтобы задать свой порядок для каждого мастера. Этот порядок сохраняется между сессиями и учитывается при экспорте.',
    aboutOutputClipboardTitle: 'Экранный вывод и буфер обмена',
    aboutOutputReveal: 'Отображение пароля на экране — временное. Доступно переключение и режим удерживания.',
    aboutOutputHold: 'Удерживание показывает секрет только пока вы удерживаете кнопку.',
    aboutOutputTimer: 'Авто‑скрытие вывода через N секунд (0 = выкл.).',
    aboutOutputExtend: 'Таймер можно продлить при необходимости.',
    aboutClipboardCopy: 'Копирование происходит только по кнопке; авто‑копирование отключено, кроме случаев, когда вы его включили.',
    aboutClipboardAutoClear: 'Буфер обмена может авто‑очищаться через N секунд для снижения рисков.',
    aboutSecurityPrivacyTitle: 'Безопасность и приватность',
    aboutSecurityMask: 'Маскирование чувствительных данных (Wayland, демонстрации) — чтобы избежать утечек на экране.',
    aboutSecurityBlockWhileCaptured: 'Блокировка при записи экрана: отключает действия, если ОС сообщает о записи/зеркалировании.',
    aboutSecurityClearOnBlur: 'Очистка при сворачивании/скрытии: убирает вывод и очищает буфер обмена при потере фокуса.',
    aboutSecurityWayland: 'Особенность Wayland: глобальное обнаружение записи ограничено — включайте маскирование.',
    aboutSecurityNoNetwork: 'Генерация офлайн — данные остаются на вашем устройстве.',
    aboutBackupTitle: 'Резервное копирование и импорт',
    aboutBackupExport: 'Экспорт бэкапа в файл .safe, который содержит только сохранённые записи (метки, постфиксы, методы, время создания и отпечатки мастера), но не содержит сам мастер‑пароль или viewer‑пароль. При задании пароля JSON внутри шифруется (Argon2id + ChaCha20‑Poly1305); без пароля остаётся открытым JSON, поэтому обычно лучше использовать сильный пароль и хранить файл в защищённом месте (зашифрованный диск, «безопасное» облако, флешка).',
    aboutBackupImport: 'Импортируйте .safe на вкладке «Резервное копирование», чтобы восстановить список Сохранённых на этом устройстве. Записи привязаны к отпечатку того мастера, под которым они были созданы, поэтому сначала настройте тот же мастер‑пароль, затем выберите — добавить к текущим записям или включить «Перезаписать» для полной замены.',
    aboutCsvTitle: 'CSV импорт/экспорт',
    aboutCsvNotes: 'CSV удобно использовать для разовой миграции или просмотра. Файл — это открытый текст с колонками «fingerprint,label,postfix,method_id,created_at,id»; при импорте вы сопоставляете импортированные отпечатки локальным Мастерам. Относитесь к CSV как к секрету (шифрования нет), держите его только на время миграции и удаляйте после использования.',
    aboutLinksTitle: 'Ссылки',
    aboutLinkSite: 'Сайт',
    aboutLinkRepo: 'Репозиторий',
    aboutSecurityTitle: 'Модель безопасности',
    aboutSec1: 'Мастер хранится только зашифрованно.',
    aboutSec2: 'Viewer не сохраняется и используется только для расшифровки мастера при генерации.',
    aboutSec3: 'Копирование — только по действию пользователя; доступна авто‑очистка буфера.',
    general: 'Общие',
    security: 'Безопасность',
    output: 'Вывод',
    close: 'Закрыть',
    helpGeneral: 'Базовые настройки приложения и значения по умолчанию.',
    helpSecurity: 'Параметры приватности и безопасности.',
    helpOutputSection: 'Отображение пароля на экране и поведение автоскрытия.',
    language: 'Язык',
    addMaster: 'Добавить мастер…',
    bindLegacy: 'Привязать старые записи к активному',
    noneSaved: 'Нет сохранённых',
    masters: 'Мастера',
    use: 'Выбрать',
    del: 'Удалить',
    active: 'Активный',
    search: 'Поиск…',
    label: 'Метка',
    method: 'Метод',
    postfix: 'Постфикс',
    actions: 'Действия',
    dragToReorder: 'Перетащите, чтобы изменить порядок',
    save: 'Сохранить',
    generate: 'Сгенерировать',
    deleteEntry: 'Удалить',
    initialSetup: 'Первичная настройка',
    masterPassword: 'Мастер‑пароль',
    confirmMaster: 'Повторите мастер‑пароль',
    viewerPassword: 'Viewer‑пароль',
    confirmViewer: 'Повторите viewer‑пароль',
    saveMaster: 'Сохранить мастер',
    defaultMethod: 'Метод по умолчанию',
    maskSensitive: 'Скрывать чувствительные данные (Linux/Wayland)',
    autosaveQuick: 'Автосохранение в консоли',
    autoClearClipboard: 'Авто‑очистка буфера (сек., 0 = выкл.)',
    helpDefault: 'Влияет на консоль и новые записи.',
    helpMask: 'На Wayland блокировка записи экрана не гарантирована — маскирование скрывает секреты.',
    helpAutosave: 'Если включено, флажок «Сохранить постфикс» включён по умолчанию.',
    helpAutoClear: 'Очищает буфер обмена через задержку; 0 — не очищать.',
    blockWhileCaptured: 'Блокировать действия при записи экрана',
    helpBlockWhileCaptured: 'Если включено, генерация/копирование отключены при активной записи/зеркалировании.',
    showPostfixInList: 'Показывать столбец постфикса (не рекомендуется)',
    helpShowPostfixInList: 'Постфикс — чувствительный ввод, обычно его лучше не показывать.',
    viewerPromptTimeoutSeconds: 'Таймаут окна viewer (секунды)',
    helpViewerPrompt: 'Автоматически закрывает окно ввода viewer при бездействии.',
    outputClearSecondsLabel: 'Авто‑скрытие вывода на экране (сек., 0 = выкл.)',
    helpOutputClear: 'Скрывает сгенерированный пароль на экране через заданное время; очистка буфера настраивается отдельно.',
    copyOnConsoleGenerate: 'Копировать в буфер после генерации в консоли',
    helpCopyOnConsole: 'Если включено, сразу копирует пароль при генерации в консоли.',
    holdOnlyReveal: 'Только удерживание для показа (без кнопки Показать/Скрыть)',
    helpHoldOnlyReveal: 'Убирает кнопку Показать/Скрыть; секрет виден лишь во время удерживания.',
    clearClipboardOnBlur: 'Очищать буфер при сворачивании/потере фокуса',
    helpClearOnBlur: 'Очищает буфер обмена и скрывает вывод при потере фокуса или скрытии окна.',
    autoCloseIn: 'Автозакрытие через',
    generating: 'Генерация…',
    deleting: 'Удаление…',
    // toasts & dialogs
    toastMasterSaved: 'Мастер‑пароль сохранён (зашифрован viewer‑паролем).',
    toastCopied: 'Скопировано в буфер обмена',
    toastCopyFailed: 'Не удалось скопировать. Скопируйте вручную.',
    toastEntryDeleted: 'Запись удалена',
    toastEntryDeleteFailed: 'Не удалось удалить запись',
    toastGenerateFailed: 'Не удалось сгенерировать',
    toastBoundEntriesPrefix: 'Привязано записей: ',
    toastBoundEntriesSuffix: '',
    toastActiveChanged: 'Активный мастер изменён',
    toastMasterDeleted: 'Мастер удалён',
    toastMasterDeleteFailed: 'Не удалось удалить',
    confirmDeleteMaster: 'Удалить этот мастер?',
    copy: 'Копировать',
    pin: 'Закрепить',
    unpin: 'Открепить',
    masterMismatch: 'Мастер‑пароли не совпадают',
    viewerMismatch: 'Viewer‑пароли не совпадают',
    errEnterBoth: 'Введите мастер‑пароль и viewer‑пароль',
    toastSaveMasterFailedPrefix: 'Не удалось сохранить мастер: ',
    toastWrongViewer: 'Неверный viewer‑пароль',
    setupMasterExplain: 'Это единственный секрет, из которого Saforia детерминированно получает пароли для всех сервисов. При смене Master поменяются и все конечные пароли, поэтому выбирайте длинную и уникальную комбинацию.',
    setupViewerExplain: 'Viewer хранится только на этом устройстве. Saforia шифрует сохранённый Master под Viewer, чтобы вредоносам было сложнее снять его в фоне. Viewer никак не связан с конечными паролями, поэтому его безопасно вводить даже под камерами.',
    setupStepLabel: 'Шаг 1 · Создание ключей',
    setupTagline: 'Задайте Master и Viewer один раз, чтобы раскрыть всё приложение.',
    setupHint: 'Эти пароли задаются один раз. Позже вы сможете изменить их в разделе «Настройки».',
    // backup
    exportToPath: 'Экспорт в файл',
    passphraseOptional: 'Пароль архива (необязательно)',
    export: 'Экспорт',
    exportedSuccessfully: 'Экспорт выполнен',
    exportFailedPrefix: 'Ошибка экспорта: ',
    exportHelp: 'Экспортирует сохранённые записи как архив Saforia (.safe) с опциональным паролем или как открытый CSV. Храните пароль в безопасности.',
    exportFormat: 'Формат экспорта',
    formatSafe: 'Архив Saforia (.safe)',
    formatCsv: 'CSV (без шифрования)',
    pickExportPath: 'Выбрать место сохранения',
    downloadBackup: 'Скачать архив',
    savingTo: 'Сохранение в',
    helpExport: 'Экспортирует сохранённые постфиксы как JSON или как зашифрованный архив при указании пароля. Храните пароль в безопасности.',
    importFromPath: 'Импорт из файла',
    passphraseIfUsed: 'Пароль архива (если использовался)',
    overwrite: 'Перезаписать',
    yes: 'Да',
    no: 'Нет',
    import: 'Импорт',
    importedCountPrefix: 'Импортировано записей: ',
    importedCountSuffix: '',
    importFailedPrefix: 'Ошибка импорта: ',
    importHelp: 'По умолчанию импорт дополняет текущие записи; включите Перезаписать для полной замены.',
    importHelpWithMapping: 'Импортируйте .safe‑архив. Если viewer на этом устройстве другой, сопоставьте каждый отпечаток с локальным мастером — несопоставленные отпечатки будут пропущены.',
    dropOrPickFile: 'Перетащите .safe/.json или выберите файл',
    acceptedFormats: 'Принимаемые форматы:',
    chooseFile: 'Выбрать файл',
    previewMapping: 'Предпросмотр и сопоставление',
    helpImport: 'По умолчанию импорт дополняет текущие записи; включите Перезаписать для полной замены.',
    helpCsv: 'Сопоставление CSV доступно только на десктопе.',
    csvBackupTitle: 'CSV‑резервная копия',
    exportCsvToPath: 'Экспорт CSV в файл',
    exportCsv: 'Экспорт CSV',
    exportedCsv: 'CSV экспортирован',
    exportCsvFailedPrefix: 'Ошибка экспорта CSV: ',
    csvImportPath: 'Импорт CSV из файла',
    previewCsvImport: 'Предпросмотр импорта CSV',
    preview: 'Предпросмотр',
    csvMapTitle: 'Сопоставление импортированных отпечатков',
    mapFingerprints: 'Сопоставьте отпечатки с локальными мастерами',
    mapFingerprintsHelp: 'Перетащите локальные отпечатки на импортированные. Будут импортированы только сопоставленные.',
    unmappedSkipped: 'Несопоставленные отпечатки будут пропущены',
    nothingMapped: 'Нечего импортировать — нет сопоставлений',
    csvAppOnly: 'Импорт/экспорт CSV доступен только в десктопном приложении.',
    desktopOnly: 'Десктоп',
    unbound: 'Без привязки',
    applyMapping: 'Применить соответствие',
    apply: 'Применить',
    dropLocalHere: 'Перетащите локальный сюда',
    dropHereToIgnore: 'Перетащите сюда, чтобы игнорировать',
    importedFingerprints: 'Импортированные отпечатки',
    localMastersDrag: 'Локальные мастера (перетащите для соответствия)',
    // overlay
    overlayTitleCapture: 'Обнаружена запись экрана',
    overlayTitleMasked: 'Скрыт чувствительный контент',
    overlayMsgCapture: 'Для вашей безопасности секреты скрываются, пока активна запись или зеркалирование.',
    overlayMsgWaylandMask: 'В Linux/Wayland блокировка записи не гарантирована. Включён режим маскировки.',
    overlayMsgMaskEnabled: 'Режим маскировки включён в настройках.',
    // reveal UI
    holdToReveal: 'Удерживайте, чтобы показать',
    releaseToHide: 'Отпустите, чтобы скрыть',
    hide: 'Скрыть',
    reveal: 'Показать',
    emptyListHelp: 'Нет сохранённых постфиксов. Используйте консоль ниже, чтобы сгенерировать и сохранить первый сайт, или выполните импорт в Резервном копировании.',
    ignore: 'Игнорировать',
    failedPrefix: 'Ошибка: ',
    toastSanitizedInput: 'Удалены невидимые/недопустимые символы из ввода.',
    warnInvisibleChars: 'Обнаружены невидимые/недопустимые символы.',
    exporting: 'Экспорт…',
    importing: 'Импорт…',
    loading: 'Загрузка…',
    applying: 'Применение…',
    postfixHiddenHint: 'Постфикс скрыт по умолчанию в целях безопасности. Включить можно в Настройки → Параметры.',
    extend: 'Продлить',
    extendSecondsLabel: 'Продлить (+с)',
    // setup placeholders / verbs
    saving: 'Сохранение…',
    masterPlaceholder: 'Надёжный мастер',
    masterRepeatPlaceholder: 'Повторите мастер',
    viewerPlaceholder: 'Viewer только на этом устройстве',
    viewerRepeatPlaceholder: 'Повторите viewer',
    // fingerprint
    fingerprintTitle: 'Отпечаток мастера',
    fingerprintHelp: 'Введите viewer‑пароль этого устройства, чтобы проверить текущую идентичность мастер‑пароля (MD5 отпечаток).',
    fingerprintLabel: 'Отпечаток (MD5 от мастера):',
    viewMaster: 'Показать мастер‑пароль',
    revealMaster: 'Показать мастер через viewer',
    copyMaster: 'Скопировать мастер',
    masterRevealed: 'Мастер‑пароль',
    revealMasterHelp: 'Введите viewer‑пароль на этом устройстве, чтобы расшифровать и показать мастер. Убедитесь, что экран вне посторонних взглядов.',
    // setup help
    setupIntro: 'Задайте надёжный Мастер‑пароль и Viewer только для этого устройства. Мастер хранится только в зашифрованном виде под Viewer и никогда не сохраняется открыто.',
    setupMasterHelp: 'Мастер — корневой секрет, из которого вычисляются ваши пароли.',
    setupViewerHelp: 'Viewer расшифровывает Мастер локально и не сохраняется.',
    setupNote1: 'Используйте длинный, уникальный Мастер (16+ символов).',
    setupNote2: 'Viewer можно сделать разным на каждом устройстве.',
    setupNote3: 'Позже можно изменить в Настройках.',
  },
  zh: {
    howItWorks: '如何工作',
    navigation: '导航',
    home: '首页',
    menu: '菜单',
    back: '返回',
    settings: '设置…',
    settingsTitle: '设置',
    tabPreferences: '偏好设置',
    tabBackup: '备份',
    tabAbout: '关于',
    quickGenerate: '快速生成',
    savedListTitle: '已保存的后缀',
    filterByMethod: '按方法筛选',
    sort: '排序',
    all: '全部',
    recent: '最近',
    alphabetical: '按字母',
    savePostfix: '保存此后缀',
    postfixPlaceholder: 'example.com',
    labelPlaceholder: '例如 Example',
    copyPassword: '复制密码',
    cancel: '取消',
    viewerHelp: '每次生成都需要 Viewer 密码，且不会被保存。',
    switchProfile: '切换配置',
    noMaster: '无主密码',
    aboutIntro: 'Saforia 是确定性密码生成器：将主密码（磁盘仅加密保存，viewer 密码用于解密）与服务后缀组合，通过哈希生成最终密码。',
    aboutSecurityTitle: '安全模型',
    aboutSec1: '主密码仅以加密形式保存。',
    aboutSec2: 'Viewer 不持久化，仅用于生成时解锁主密码。',
    aboutSec3: '复制需显式操作；支持自动清除剪贴板。',
    aboutBackupTitle: '备份与导入',
    aboutBackupExport: '将备份导出为 .safe 文件，其中只包含已保存条目（标签、后缀、方法、创建时间以及主密码指纹），不会包含主密码或 Viewer 密码本身。若设置口令，内部 JSON 会通过 Argon2id + ChaCha20‑Poly1305 加密；如果不设口令则为明文 JSON，因此推荐使用强口令，并将文件保存在受保护的位置（如加密磁盘、安全云盘或 U 盘）。',
    aboutBackupImport: '在“备份”页从 .safe 文件导入，在本设备上恢复已保存列表。条目会绑定到它们创建时对应的主密码指纹，因此请先在新设备上配置相同的主密码，然后选择与现有条目合并，或启用“覆盖”以完全替换当前列表。',
    aboutCsvTitle: 'CSV 导入/导出',
    aboutCsvNotes: 'CSV 适合一次性迁移或检查内容。文件是明文文本，列为 “fingerprint,label,postfix,method_id,created_at,id”；导入时你需要将导入的指纹映射到本地主密码。CSV 不加密，请将其视为敏感数据，仅在迁移期间短暂保存，并在完成后删除。',
    aboutUsingTitle: '使用技巧',
    aboutUsingQuick: '快速生成：输入后缀、选择方法、生成并复制。可选“保存该后缀”。',
    aboutUsingSave: '保存：勾选“保存该后缀”，并设置简短标签（如 Example）。',
    aboutUsingSaved: '已保存条目：直接打开 Viewer 提示并复制，无需重新输入后缀。',
    aboutUsingShowPostfixWarning: '一般不建议在列表中显示后缀（属于敏感输入），仅在确有需要时开启。',
    aboutUsingReorder: '排序：通过拖动句柄重新排列保存行；顺序按主密码独立保存，并在会话之间及导出时保持一致。',
    general: '常规',
    security: '安全',
    output: '输出',
    close: '关闭',
    helpGeneral: '基础应用偏好和默认值。',
    helpSecurity: '隐私与安全相关选项。',
    helpOutputSection: '屏幕输出以及显示/过期行为。',
    language: '语言',
    addMaster: '添加主密码…',
    bindLegacy: '绑定旧条目到当前',
    noneSaved: '没有保存的项目',
    masters: '主密码',
    use: '使用',
    del: '删除',
    active: '当前',
    search: '搜索…',
    label: '标签',
    method: '方法',
    postfix: '后缀',
    actions: '操作',
    dragToReorder: '拖动以重新排序',
    save: '保存',
    generate: '生成',
    deleteEntry: '删除',
    initialSetup: '首次设置',
    masterPassword: '主密码',
    confirmMaster: '确认主密码',
    viewerPassword: 'Viewer 密码',
    confirmViewer: '确认 Viewer 密码',
    saveMaster: '保存主密码',
    defaultMethod: '默认方法',
    maskSensitive: '隐藏敏感内容（Linux/Wayland）',
    autosaveQuick: '控制台自动保存',
    autoClearClipboard: '自动清除剪贴板（秒，0 关闭）',
    helpDefault: '影响控制台和新建条目。',
    helpMask: '在 Wayland 平台，录屏拦截不可靠，建议隐藏敏感内容。',
    helpAutosave: '若启用，则默认勾选“保存后缀”。',
    helpAutoClear: '一段时间后清空剪贴板；0 表示不清空。',
    blockWhileCaptured: '检测到录屏时阻止操作',
    helpBlockWhileCaptured: '启用后，在系统报告录制/镜像时禁用生成/复制。',
    showPostfixInList: '在列表中显示后缀（不建议）',
    helpShowPostfixInList: '后缀属于敏感输入，通常不应显示。',
    viewerPromptTimeoutSeconds: 'Viewer 提示超时（秒）',
    helpViewerPrompt: '在无操作时自动关闭 Viewer 提示以防旁窥。',
    outputClearSecondsLabel: '自动隐藏屏幕输出（秒，0 关闭）',
    helpOutputClear: '在一段时间后隐藏屏幕上的密码；剪贴板清除单独设置。',
    copyOnConsoleGenerate: '控制台生成后复制到剪贴板',
    helpCopyOnConsole: '启用后，在控制台生成时立即复制密码。',
    holdOnlyReveal: '仅按住显示（隐藏显示/隐藏按钮）',
    helpHoldOnlyReveal: '移除显示/隐藏按钮；仅按住时可见。',
    clearClipboardOnBlur: '应用失焦/隐藏时清空剪贴板',
    helpClearOnBlur: '当应用失去焦点或隐藏时清空剪贴板并隐藏输出。',
    autoCloseIn: '自动关闭于',
    generating: '正在生成…',
    deleting: '正在删除…',
    // toasts & dialogs
    toastMasterSaved: '主密码已保存（由 Viewer 密码加密）。',
    toastCopied: '已复制到剪贴板',
    toastCopyFailed: '复制失败，请手动复制。',
    toastEntryDeleted: '条目已删除',
    toastEntryDeleteFailed: '删除条目失败',
    toastGenerateFailed: '生成失败',
    toastBoundEntriesPrefix: '已绑定 ',
    toastBoundEntriesSuffix: ' 条',
    toastActiveChanged: '已切换当前主密码',
    toastMasterDeleted: '主密码已删除',
    toastMasterDeleteFailed: '删除失败',
    confirmDeleteMaster: '删除此主密码？',
    copy: '复制',
    pin: '固定',
    unpin: '取消固定',
    masterMismatch: '主密码不一致',
    viewerMismatch: 'Viewer 密码不一致',
    errEnterBoth: '请输入主密码和 Viewer 密码',
    toastSaveMasterFailedPrefix: '保存主密码失败：',
    toastWrongViewer: 'Viewer 密码错误',
    setupMasterExplain: '这是 Saforia 为所有网站确定性生成密码的唯一根秘密。更换 Master 会让所有网站的密码同时变化，因此请选择足够长且独特的组合。',
    setupViewerExplain: 'Viewer 仅保存在本设备。Saforia 会用 Viewer 在本地加密保存的 Master，防止恶意程序静默读取。Viewer 与最终网站密码无任何关联，即使在摄像头前输入也安全。',
    setupStepLabel: '步骤 1 · 创建密钥',
    setupTagline: '先配置 Master 与 Viewer，之后即可完整使用应用。',
    setupHint: '这些密码通常只需设置一次，如有需要可在设置中调整。',
    // backup
    exportToPath: '导出到路径',
    passphraseOptional: '归档口令（可选）',
    export: '导出',
    exportedSuccessfully: '导出成功',
    exportFailedPrefix: '导出失败：',
    exportHelp: '导出为 Saforia 加密归档（.safe，可选口令）或明文 CSV。请妥善保管口令。',
    exportFormat: '导出格式',
    formatSafe: 'Saforia 归档 (.safe)',
    formatCsv: 'CSV（明文未加密）',
    pickExportPath: '选择保存位置',
    downloadBackup: '下载备份',
    savingTo: '保存到',
    helpExport: '导出为 JSON；若提供口令则导出加密归档。请妥善保管口令。',
    importFromPath: '从路径导入',
    passphraseIfUsed: '归档口令（如使用）',
    overwrite: '覆盖',
    yes: '是',
    no: '否',
    import: '导入',
    importedCountPrefix: '已导入 ',
    importedCountSuffix: ' 条',
    importFailedPrefix: '导入失败：',
    importHelp: '默认合并导入；选择覆盖以替换全部。',
    importHelpWithMapping: '导入 .safe 备份。如果本设备的 Viewer 不同，请将每个导入的指纹拖拽到本地主密码上；未映射的指纹会被跳过。',
    dropOrPickFile: '拖拽 .safe/.json 或选择文件',
    acceptedFormats: '可接受格式：',
    chooseFile: '选择文件',
    previewMapping: '预览并映射',
    helpImport: '默认合并导入；选择覆盖以替换全部。',
    helpCsv: 'CSV 映射目前仅在桌面端可用。',
    csvBackupTitle: 'CSV 备份',
    exportCsvToPath: '导出 CSV 到路径',
    exportCsv: '导出 CSV',
    exportedCsv: 'CSV 已导出',
    exportCsvFailedPrefix: '导出 CSV 失败：',
    csvImportPath: '从路径导入 CSV',
    previewCsvImport: '预览 CSV 导入',
    preview: '预览',
    csvMapTitle: '映射导入的指纹',
    mapFingerprints: '将指纹映射到本地主密码',
    mapFingerprintsHelp: '将本地指纹拖拽到导入的指纹上。仅映射的指纹会被导入。',
    unmappedSkipped: '未映射的指纹将被跳过',
    nothingMapped: '没有可导入的映射',
    csvAppOnly: 'CSV 导入/导出仅在桌面应用中提供。',
    desktopOnly: '仅桌面端',
    unbound: '未绑定',
    applyMapping: '应用映射',
    apply: '应用',
    dropLocalHere: '拖拽本地到此处',
    dropHereToIgnore: '拖拽到此处忽略',
    importedFingerprints: '导入的指纹',
    localMastersDrag: '本地主密码（拖拽以映射）',
    // overlay
    overlayTitleCapture: '检测到屏幕录制',
    overlayTitleMasked: '敏感内容已隐藏',
    overlayMsgCapture: '为安全起见，录制/镜像时隐藏敏感内容。',
    overlayMsgWaylandMask: 'Linux/Wayland 上录屏拦截不可靠，已启用隐藏模式。',
    overlayMsgMaskEnabled: '已在设置中启用隐藏模式。',
    // reveal UI
    holdToReveal: '按住显示',
    releaseToHide: '松开隐藏',
    hide: '隐藏',
    reveal: '显示',
    emptyListHelp: '尚无保存的后缀。使用下方控制台生成并保存，或在备份中导入。',
    ignore: '忽略',
    failedPrefix: '失败：',
    toastSanitizedInput: '已从输入中移除不可见/不支持字符。',
    warnInvisibleChars: '输入包含不可见/不支持字符。',
    exporting: '正在导出…',
    importing: '正在导入…',
    loading: '正在加载…',
    applying: '正在应用…',
    postfixHiddenHint: '出于安全，默认隐藏后缀。可在 设置 → 偏好 中开启。',
    extend: '延长',
    extendSecondsLabel: '延长（+秒）',
    // setup placeholders / verbs
    saving: '正在保存…',
    masterPlaceholder: '强主密码',
    masterRepeatPlaceholder: '重复主密码',
    viewerPlaceholder: '仅此设备的 Viewer',
    viewerRepeatPlaceholder: '重复 Viewer',
    // fingerprint
    fingerprintTitle: '主密码指纹',
    fingerprintHelp: '输入本设备的 Viewer 密码以验证当前主密码身份（MD5 指纹）。',
    fingerprintLabel: '指纹（主密码 MD5）：',
    viewMaster: '查看主密码',
    revealMaster: '使用 Viewer 查看主密码',
    copyMaster: '复制主密码',
    masterRevealed: '主密码',
    revealMasterHelp: '输入本设备的 Viewer 密码以解密主密码。显示前请确保屏幕安全。',
    // setup help
    setupIntro: '设置强主密码（Master）和仅此设备的 Viewer。主密码仅以加密形式保存，由 Viewer 解密，绝不以明文存储。',
    setupMasterHelp: 'Master 是用于派生密码的根秘密。',
    setupViewerHelp: 'Viewer 仅在本地解密 Master，不会被持久化。',
    setupNote1: '使用足够长且唯一的 Master（建议 16+ 字符）。',
    setupNote2: 'Viewer 可在不同设备设置不同，便于记忆。',
    setupNote3: '之后可在设置中修改。',
  }
}

type Ctx = { lang: Lang, t: (k: string) => string, setLang: (l: Lang) => void }
const I18nContext = React.createContext<Ctx>({ lang: 'en', t: (k) => k, setLang: () => {} })

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const nav = (typeof navigator !== 'undefined' && navigator.language || 'en').toLowerCase()
  const guess: Lang = nav.startsWith('ru') ? 'ru' : nav.startsWith('zh') ? 'zh' : 'en'
  const [lang, setLangState] = React.useState<Lang>(() => {
    try { return (localStorage.getItem('saforia_lang') as Lang) || guess } catch { return guess }
  })
  const setLang = React.useCallback((l: Lang) => {
    try { localStorage.setItem('saforia_lang', l) } catch {}
    setLangState(l)
  }, [])
  React.useEffect(() => {
    // Try to sync with persisted app prefs (mock or tauri backend)
    invoke<{ lang?: string }>('get_prefs').then(p => {
      const v = (p?.lang || '').toLowerCase()
      if (v === 'en' || v === 'ru' || v === 'zh') setLangState(v as Lang)
    }).catch(() => {})
  }, [])
  const t = React.useCallback((k: string) => bundle[lang][k] || bundle.en[k] || k, [lang])
  return <I18nContext.Provider value={{ lang, t, setLang }}>{children}</I18nContext.Provider>
}

export function useI18n() { return React.useContext(I18nContext) }
